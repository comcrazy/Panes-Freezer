/*!
 * jQuery Panes Freezer v0.1.0 - Freeze the table column and row for ease of navagating
 * 
 * Copyright (c) 2011 James ong, http://comcrazy.info/
 * 
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 * 
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * 
 * http://comcrazy.info/2011/10/jquery-panes-freezer.html
 *
 * -----
 * 
 */
(function(a){var b={init:function(c){return this.each(function(){var d={headerrow:1,headercolumn:0};if(c){a.extend(d,c)}if(!a(this).is("div")){a.error("jQuery.staticheader: Only can initiate at a DIV element:"+a(this).attr("id"))}if(a(this).children().length==0){a.error("jQuery.staticheader: There must be a TABLE element under this DIV:"+a(this).attr("id"))}if(a(this).children().length>1||!a(a(this).children().get(0)).is("table")){a.error("jQuery.staticheader: There only can be one element under this DIV and must be TABLE:"+a(this).attr("id"))}if(a(a(this).children().get(0)).attr("id")==undefined||a(a(this).children().get(0)).attr("id")==""){a.error("jQuery.staticheader: TABLE element must had uniqeu ID:"+a(this).attr("id"))}var e="";var f="";var g=0;var h=0;var i="";var j=0;var k=new Array;var l=new Array;var m=new Array;var n=a(this);var o=a(this).attr("id");var p=a(a(this).children().get(0));var q=a(p).width();var r=p.children().get(0);var s=b.getTableWidthOffset(p);if(r==undefined){a.error("jQuery.staticheader: No row found in table")}if(!a(r).is("tr")&&!a(r).is("thead")&&!a(r).is("tbody")){a.error("jQuery.staticheader: Expect first row should either be THEAD or TR element")}if(d["headerrow"]>0){var t=null;var u=null;var v=null;if(a(r).is("thead")){u=a(r);r=a(r).children().get(0)}else if(a(r).is("tbody")){v=a(r);r=a(r).children().get(0)}if(a(!r).is("tr")){a.error("jQuery.staticheader: Expect TR element under THEAD element")}var w=d["headerrow"];do{if(u!=null){t=u.children().get(w)}else if(v!=null){t=v.children().get(w)}if(t==undefined||t==null){if(u!=null){var x=1;t=p.children().get(x);x++;if(a(t).is("tfoot")){t=p.children().get(x);x++}if(a(t).is("tbody")){t=a(t).children().get(w-u.children().length)}else{t=null;break}}else{t=null;break}}w++}while(!a(t).is("tr"));var y=d["headerrow"];var z=0;var A=new Array;e+="<table ";e+=b.getElementAttribute.apply(this,new Array(p));e+=">";if(d["headercolumn"]>0){f+="<table ";f+=b.getElementAttribute.apply(this,new Array(p));f+=">"}while(y>0){h+=b.getAbsoluteCellHeight(a(r));e+="<tr ";e+=b.getElementAttribute.apply(this,new Array(r));e+=">";if(d["headercolumn"]>0){f+="<tr ";f+=b.getElementAttribute.apply(this,new Array(r));f+=">"}a(r).children().each(function(c){var h="";var i=a(this).is("td")?"td":a(this).is("th")?"th":"";h+="<"+i+" ";h+=b.getElementAttribute.apply(this,new Array(this));var j=a(t).children().get(c);var l=0;var n=b.getAbsoluteCellHeight(a(this));if(y==d["headerrow"]){l=b.getAbsoluteCellWidth(a(this));k[c]=l}else{l=k[c]}m[c]=b.getCellWidthOffset(a(this));a(j).css("min-width",l+"px");a(j).css("max-width",l+"px");a(j).css("width",l+"px");if(h.match("style=")){h=h.replace(/style="/i,'style="width:'+l+"px;min-width:"+l+"px; max-width:"+l+"px ")}else{h+='style="width:'+l+"px;min-width:"+l+"px; max-width:"+l+'px" '}n=b.getAbsoluteCellHeight(a(this));if(h.match("height:")&&n!=""&&n!=undefined){h=h.replace(/min-height:(\S|\s)[0-9]*(\S|\s)x;/i,"min-height:"+n+"px;");h=h.replace(/min-height:(\S|\s)[0-9]*(\S|\s)x/i,"min-height:"+n+"px");h=h.replace(/max-height:(\S|\s)[0-9]*(\S|\s)x;/i,"max-height:"+n+"px;");h=h.replace(/max-height:(\S|\s)[0-9]*(\S|\s)x/i,"max-height:"+n+"px");h=h.replace(/height:(\S|\s)[0-9]*(\S|\s)x;/i,"height:"+n+"px;");h=h.replace(/height:(\S|\s)[0-9]*(\S|\s)x/i,"height:"+n+"px")}else if(h.match("height=")&&n!=""&&n!=undefined){h=h.replace(/height="[0-9]*px"/i,'height="'+n+'px"')}else if(h.match("style=")&&n!=""&&n!=undefined){h=h.replace(/style="/i,'style="height:'+n+"px; ")}else if(n!=""&&n!=undefined){h+=' style="height:'+n+'px" '}h+=">"+a(this).html();h+="</"+i+">";if(d["headercolumn"]>0&&c<d["headercolumn"]){if(c==0){g+=l+b.getCellWidthOffset(a(this))}f+=h}else{e+=h}});e+="</tr>";if(d["headercolumn"]>0){f+="</tr>"}A[z]=r;y--;z++;if(y>0){if(u!=null){r=u.children().get(z)}else if(v!=null){r=v.children().get(z)}else{r=p.children().get(z)}if(r==undefined||r==null){if(u!=null){r=p.find("tbody");if(r!=undefined){r=a(r).children().get(0)}else{y=0}}else{y=0}}}}jQuery.each(A,function(b){a(A[b]).remove()});e+="</table>";if(d["headercolumn"]>0){f+="</table>"}}if(d["headercolumn"]>0){var B="<tbody>";var C="<tfoot>";var D=a(p).find("tr");a(D).each(function(c){var e=0;var f=a(this).parent().is("tfoot");var g="<tr ";g+=b.getElementAttribute.apply(this,new Array(this));g+=">";var h=d["headercolumn"];var i=0;var l="";while(h>0){var n=a(this).children().get(i);var o=a(this).children().get(i+1);var p=a(n).is("td")?"td":a(n).is("th")?"th":"";var q="";if(i==0){e=b.getAbsoluteCellHeight(a(n))}q+="<"+p+" ";q+=b.getElementAttribute.apply(this,new Array(n));var r=k[i]==undefined?a(n).width():k[i];if(c==0){j+=r+(m[i]==undefined?b.getCellWidthOffset(a(n)):m[i])}if(q.match("width:")&&r!=""&&r!=undefined){q=q.replace(/min-width:(\S|\s)[0-9]*(\S|\s)x;/i,"min-width:"+r+"px;");q=q.replace(/min-width:(\S|\s)[0-9]*(\S|\s)x/i,"min-width:"+r+"px");q=q.replace(/max-width:(\S|\s)[0-9]*(\S|\s)x;/i,"max-width:"+r+"px;");q=q.replace(/max-width:(\S|\s)[0-9]*(\S|\s)x/i,"max-width:"+r+"px");q=q.replace(/width:(\S|\s)[0-9]*(\S|\s)x;/i,"width:"+r+"px;");q=q.replace(/width:(\S|\s)[0-9]*(\S|\s)x/i,"width:"+r+"px")}else if(q.match("width=")&&r!=""){q=q.replace(/width="[0-9]*px"/i,'width="'+r+'px"')}else if(q.match("style=")&&r!=""&&r!=undefined){q=q.replace(/style="/i,'style="width:'+r+"px; ")}else if(r!=0){q+=' style="width:'+r+'px" '}var s=b.getAbsoluteCellHeight(a(n));if(q.match("height:")&&s!=""&&s!=undefined){q=q.replace(/min-height:(\S|\s)[0-9]*(\S|\s)x;/i,"min-height:"+s+"px;");q=q.replace(/min-height:(\S|\s)[0-9]*(\S|\s)x/i,"min-height:"+s+"px");q=q.replace(/max-height:(\S|\s)[0-9]*(\S|\s)x;/i,"max-height:"+s+"px;");q=q.replace(/max-height:(\S|\s)[0-9]*(\S|\s)x/i,"max-height:"+s+"px");q=q.replace(/height:(\S|\s)[0-9]*(\S|\s)x;/i,"height:"+s+"px;");q=q.replace(/height:(\S|\s)[0-9]*(\S|\s)x/i,"height:"+s+"px")}else if(q.match("height=")&&s!=""){q=q.replace(/height="[0-9]*px"/i,'height="'+s+'px"')}else if(q.match("style=")&&s!=""&&s!=undefined){q=q.replace(/style="/i,'style="height:'+s+"px; ")}else if(s!=0){q+=' style="height:'+s+'px" '}q+=">";q+=a(n).html();q+="</"+p+">";l+=q;i++;h--}if(f){C+=g+l+"</tr>"}else{B+=g+l+"</tr>"}var t=a(this).children().get();if(t!=undefined){a(t).css("height",e);a(t).css("min-height",e);a(t).css("max-height",e)}});D=a(p).find("tr");a(D).each(function(){var b=new Array;var c=d["headercolumn"];var e=0;while(c>0){var f=a(this).children().get(e);b[e]=f;e++;c--}jQuery.each(b,function(c){a(b[c]).remove()})});i+="<table ";i+=b.getElementAttribute.apply(this,new Array(p));i=i.replace(/min-width:(\S|\s)[0-9]*(\S|\s)x;/i,"");i=i.replace(/min-width:(\S|\s)[0-9]*(\S|\s)x/i,"");i=i.replace(/max-width:(\S|\s)[0-9]*(\S|\s)x;/i,"");i=i.replace(/max-width:(\S|\s)[0-9]*(\S|\s)x/i,"");i=i.replace(/width:(\S|\s)[0-9]*(\S|\s)x;/i,"");i=i.replace(/width:(\S|\s)[0-9]*(\S|\s)x/i,"");i=i.replace(/width="[0-9]*px"/i,"");i+=">";i+=B+"</tbody>"+C+"</tfoot>";i+="</table>"}a(p).width(q-j);a(p).find("thead").children().length==0?a(p).find("thead").remove():null;var E="";if(f.length!=0||e.length!=0){E+='<div id="staticheader_hs_'+o+'"  >';if(f.length!=0){E+='<div id="staticheader_subhs1_'+o+'" style="float: left;">';E+=f;E+="</div>"}if(e.length!=0){E+='<div id="staticheader_subhs2_'+o+'" style="float: left; overflow: hidden;  width:'+(a(this).width()-j-s-2*d["headercolumn"]-20)+'px">';E+=e;E+="</div>"}E+="</div>"}E+='<div id="staticheader_hp_'+o+'">';if(i.length!=0){E+='<div id="staticheader_subhp1_'+o+'" style="float: left;">';E+='<div id="staticheader_chs_'+o+'" style="overflow: hidden; overflow: hidden; height: '+(a(this).height()-(h+35))+'px;">';E+=i;E+="</div>";E+="</div>"}E+='<div id="staticheader_subhp2_'+o+'" style="float: left">';E+='<div id="staticheader_cs_'+o+'" style="overflow: hidden; height: '+(a(this).height()-(h+35))+"px; width:"+(a(this).width()-j-s-2*d["headercolumn"]-20)+'"px>';E+=n.html();E+="</div>";E+="</div>";E+='<div id="staticheader_subhp3_'+o+'" style="float:left">';E+='<div id="staticheader_hscr_'+o+'" style="overflow: auto; width: 20px; height:'+(a(this).height()-(h+35))+'px;"><div style="margin: 0 0; padding:0 0; width: 1px; height: '+(a(p).height()+35)+'px;"></div></div>';E+="</div>";E+="</div>";E+='<div id="staticheader_vscr_'+o+'" style="padding: 0px; margin-left:'+(d["headercolumn"]>0?j+s+2*d["headercolumn"]:0)+"px; float: left; overflow: auto;height: 20px; clear:both; width:"+(a(this).width()-j-s-2*d["headercolumn"]-20)+'"px">';E+='<div style="margin: 0 0; padding:0 0;  width: '+(a(p).width()+s)+'px; height: 1px">';E+="</div>";E+="</div>";n.html(E);a("#staticheader_vscr_"+o).scroll(function(){a("#staticheader_subhs2_"+o).scrollLeft(a("#staticheader_vscr_"+o).scrollLeft());a("#staticheader_cs_"+o).scrollLeft(a("#staticheader_vscr_"+o).scrollLeft())});a("#staticheader_hscr_"+o).scroll(function(){a("#staticheader_cs_"+o).scrollTop(a("#staticheader_hscr_"+o).scrollTop());a("#staticheader_chs_"+o).scrollTop(a("#staticheader_hscr_"+o).scrollTop())});n.css("text-align","left")})},getElementAttribute:function(b){if(b==undefined){return""}var c=["border","class","style","cellpadding","cellspacing","valign","title","lang","dir","accesskey","tabindex"];var d="";jQuery.each(c,function(c,e){if(a(b).attr(e)!=undefined&&a(b).attr(e)!=""){d+=this+'="'+a(b).attr(e)+'" '}});return d},getTableWidthOffset:function(a){var c=0;if(a.attr("border")!=undefined&&a.attr("border")!=""){c+=a.attr("border")*2}if(a.css("border-width")!=""){c+=b.px2Int(new Array(a.css("border-width")))*2}if(a.css("margin-left")!=""){c+=b.px2Int(new Array(a.css("margin-left")))}if(a.css("margin-right")!=""){c+=b.px2Int(new Array(a.css("margin-right")))}if(a.css("padding-left")!=""){c+=b.px2Int(new Array(a.css("padding-left")))}if(a.css("padding-right")!=""){c+=b.px2Int(new Array(a.css("padding-right")))}return c},getCellWidthOffset:function(c){var d=0;if(c.css("padding-left")!=""){d+=b.px2Int(new Array(a(c).css("padding-left")))}if(c.css("padding-right")!=""){d+=b.px2Int(new Array(a(c).css("padding-right")))}if(c.css("margin-left")!=""){d+=b.px2Int(new Array(a(c).css("margin-left")))}if(c.css("margin-right")!=""){d+=b.px2Int(new Array(a(c).css("margin-right")))}if(c.css("border-spacing")!=""){tmp_value=c.css("border-spacing").split(" ");d+=b.px2Int(new Array(tmp_value[0]));d+=b.px2Int(new Array(tmp_value[1]))}return d},getAbsoluteCellHeight:function(a){return a.height()>a[0].offsetHeight?a.height():a[0].offsetHeight},getAbsoluteCellWidth:function(a){return a.width()>a[0].offsetWidth?a.width():a[0].offsetWidth},px2Int:function(a){if(a==undefined||a==""){return 0}return a[0].replace(/px/i,"")*1}};a.fn.panesfreezer=function(c){if(b[c]){return b[c].apply(this,Array.prototype.slice.call(arguments,1))}else if(typeof c==="object"||!c){return b.init.apply(this,arguments)}else{a.error("Method "+c+" does not exist on jQuery.panesfreezer")}}})(jQuery)