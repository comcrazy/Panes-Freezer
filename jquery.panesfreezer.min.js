/*!
 * jQuery Panes Freezer v0.1.0 - Freeze the table column and row for ease of navagating
 * 
 * Copyright (c) 2011 James ong, http://comcrazy.info/
 * 
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 * 
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * 
 * http://comcrazy.info/2011/10/jquery-panes-freezer.html
 *
 * -----
 * 
 */
(function(a){var b={init:function(c){return this.each(function(){var d={headerrow:1,headercolumn:0};if(c){a.extend(d,c)}if(!a(this).is("div")){a.error("jQuery.staticheader: Only can initiate at a DIV element:"+a(this).attr("id"))}if(a(this).children().length==0){a.error("jQuery.staticheader: There must be a TABLE element under this DIV:"+a(this).attr("id"))}if(a(this).children().length>1||!a(a(this).children().get(0)).is("table")){a.error("jQuery.staticheader: There only can be one element under this DIV and must be TABLE:"+a(this).attr("id"))}if(a(a(this).children().get(0)).attr("id")==undefined||a(a(this).children().get(0)).attr("id")==""){a.error("jQuery.staticheader: TABLE element must had uniqeu ID:"+a(this).attr("id"))}var e="";var f="";var g=0;var h=0;var i="";var j=0;var k=new Array;var l=new Array;var m=new Array;var n=a(this);var o=a(this).attr("id");var p=a(a(this).children().get(0));var q=a(p).width();var r=p.children().get(0);var s=b.getTableWidthOffset(p);if(r==undefined){a.error("jQuery.staticheader: No row found in table")}if(!a(r).is("tr")&&!a(r).is("thead")&&!a(r).is("tbody")){a.error("jQuery.staticheader: Expect first row should either be THEAD or TR element")}if(d["headerrow"]>0){var t=null;var u=null;var v=null;if(a(r).is("thead")){u=a(r);r=a(r).children().get(0)}else if(a(r).is("tbody")){v=a(r);r=a(r).children().get(0)}if(a(!r).is("tr")){a.error("jQuery.staticheader: Expect TR element under THEAD element")}var w=d["headerrow"];do{if(u!=null){t=u.children().get(w)}else if(v!=null){t=v.children().get(w)}if(t==undefined||t==null){if(u!=null){var x=1;t=p.children().get(x);x++;if(a(t).is("tfoot")){t=p.children().get(x);x++}if(a(t).is("tbody")){t=a(t).children().get(w-u.children().length)}else{t=null;break}}else{t=null;break}}w++}while(!a(t).is("tr"));var y=d["headerrow"];var z=0;var A=new Array;e+="<table ";e+=b.getElementAttribute.apply(this,new Array(p));e+=">";if(d["headercolumn"]>0){f+="<table ";f+=b.getElementAttribute.apply(this,new Array(p));f+=">"}while(y>0){h+=b.getAbsoluteCellHeight(a(r));e+="<tr ";e+=b.getElementAttribute.apply(this,new Array(r));e+=">";if(d["headercolumn"]>0){f+="<tr ";f+=b.getElementAttribute.apply(this,new Array(r));f+=">"}a(r).children().each(function(c){var h="";var i=false;var j=a(this).is("td")?"td":a(this).is("th")?"th":"";h+="<"+j+" ";h+=b.getElementAttribute.apply(this,new Array(this));if(h.match("rowspan")&&a(this).attr("rowspan")>1){a.error("jQuery.staticheader: Unexpected table cell with rowspan detected. Cell with rowspan must not be used as row header.")}if(h.match("colspan")&&a(this).attr("colspan")>1){i=true}var l=a(t).children().get(c);var n=0;var o=b.getAbsoluteCellHeight(a(this));if(k[c]==undefined&&!i){n=b.getAbsoluteCellWidth(a(this));k[c]=n}else if(!i){n=k[c]}else{n=b.getAbsoluteCellWidth(a(this))}m[c]=b.getCellWidthOffset(a(this));if(n!=0&&!i){a(l).css("min-width",n+"px");a(l).css("max-width",n+"px");a(l).css("width",n+"px")}if(n!=0){if(h.match("style=")){h=h.replace(/style="/i,'style="width:'+n+"px;min-width:"+n+"px; max-width:"+n+"px ")}else{h+='style="width:'+n+"px;min-width:"+n+"px; max-width:"+n+'px" '}}o=b.getAbsoluteCellHeight(a(this));if(h.match("height:")&&o!=""&&o!=undefined){h=h.replace(/min-height:(\S|\s)[0-9]*(\S|\s)x;/i,"min-height:"+o+"px;");h=h.replace(/min-height:(\S|\s)[0-9]*(\S|\s)x/i,"min-height:"+o+"px");h=h.replace(/max-height:(\S|\s)[0-9]*(\S|\s)x;/i,"max-height:"+o+"px;");h=h.replace(/max-height:(\S|\s)[0-9]*(\S|\s)x/i,"max-height:"+o+"px");h=h.replace(/height:(\S|\s)[0-9]*(\S|\s)x;/i,"height:"+o+"px;");h=h.replace(/height:(\S|\s)[0-9]*(\S|\s)x/i,"height:"+o+"px")}else if(h.match("height=")&&o!=""&&o!=undefined){h=h.replace(/height="[0-9]*px"/i,'height="'+o+'px"')}else if(h.match("style=")&&o!=""&&o!=undefined){h=h.replace(/style="/i,'style="height:'+o+"px; ")}else if(o!=""&&o!=undefined){h+=' style="height:'+o+'px" '}h+=">"+a(this).html();h+="</"+j+">";if(d["headercolumn"]>0&&c<d["headercolumn"]){if(c==0){g+=n+b.getCellWidthOffset(a(this))}f+=h}else{e+=h}});e+="</tr>";if(d["headercolumn"]>0){f+="</tr>"}A[z]=r;y--;z++;if(y>0){if(u!=null){r=u.children().get(z)}else if(v!=null){r=v.children().get(z)}else{r=p.children().get(z)}if(r==undefined||r==null){if(u!=null){r=p.find("tbody");if(r!=undefined){r=a(r).children().get(0)}else{y=0}}else{y=0}}}}jQuery.each(A,function(b){a(A[b]).remove()});e+="</table>";if(d["headercolumn"]>0){f+="</table>"}}if(d["headercolumn"]>0){var B=new Array;var C="<tbody>";var D="<tfoot>";var E=a(p).find("tr");a(E).each(function(c){var e=0;var f=a(this).parent().is("tfoot");var g="<tr ";g+=b.getElementAttribute.apply(this,new Array(this));g+=">";var h=d["headercolumn"];var i=0;var l="";var n=false;while(h>0){var o=i;if(B[i]!=undefined&&B[i]>1){B[i]=B[i]-1;i++;h--;n=true;continue}if(n){n=false;o--}var p=a(this).children().get(o);var q=a(p).is("td")?"td":a(p).is("th")?"th":"";var r="";var s=false;r+="<"+q+" ";r+=b.getElementAttribute.apply(this,new Array(p));if(r.match("colspan")&&a(p).attr("colspan")>1){a.error("jQuery.staticheader: Unexpected table cell with colspan detected. Cell with colspan must not be used as column header.")}if(r.match("rowspan")&&a(p).attr("rowspan")>1){B[i]=a(p).attr("rowspan");s=true}if(i==0&&!s||i>0&&B[i-1]!=undefined){e=b.getAbsoluteCellHeight(a(p))}var t=k[i]==undefined?a(p).width():k[i];if(c==0){j+=t+(m[i]==undefined?b.getCellWidthOffset(a(p)):m[i])}if(r.match("width:")&&t!=""&&t!=undefined){r=r.replace(/min-width:(\S|\s)[0-9]*(\S|\s)x;/i,"min-width:"+t+"px;");r=r.replace(/min-width:(\S|\s)[0-9]*(\S|\s)x/i,"min-width:"+t+"px");r=r.replace(/max-width:(\S|\s)[0-9]*(\S|\s)x;/i,"max-width:"+t+"px;");r=r.replace(/max-width:(\S|\s)[0-9]*(\S|\s)x/i,"max-width:"+t+"px");r=r.replace(/width:(\S|\s)[0-9]*(\S|\s)x;/i,"width:"+t+"px;");r=r.replace(/width:(\S|\s)[0-9]*(\S|\s)x/i,"width:"+t+"px")}else if(r.match("width=")&&t!=""){r=r.replace(/width="[0-9]*px"/i,'width="'+t+'px"')}else if(r.match("style=")&&t!=""&&t!=undefined){r=r.replace(/style="/i,'style="width:'+t+"px; ")}else if(t!=0){r+=' style="width:'+t+'px" '}var u=b.getAbsoluteCellHeight(a(p));if(r.match("height:")&&u!=""&&u!=undefined){r=r.replace(/min-height:(\S|\s)[0-9]*(\S|\s)x;/i,"min-height:"+u+"px;");r=r.replace(/min-height:(\S|\s)[0-9]*(\S|\s)x/i,"min-height:"+u+"px");r=r.replace(/max-height:(\S|\s)[0-9]*(\S|\s)x;/i,"max-height:"+u+"px;");r=r.replace(/max-height:(\S|\s)[0-9]*(\S|\s)x/i,"max-height:"+u+"px");r=r.replace(/height:(\S|\s)[0-9]*(\S|\s)x;/i,"height:"+u+"px;");r=r.replace(/height:(\S|\s)[0-9]*(\S|\s)x/i,"height:"+u+"px")}else if(r.match("height=")&&u!=""){r=r.replace(/height="[0-9]*px"/i,'height="'+u+'px"')}else if(r.match("style=")&&u!=""&&u!=undefined){r=r.replace(/style="/i,'style="height:'+u+"px; ")}else if(u!=0){r+=' style="height:'+u+'px" '}r+=">";r+=a(p).html();r+="</"+q+">";l+=r;i++;h--}if(f){D+=g+l+"</tr>"}else{C+=g+l+"</tr>"}var v=a(this).children().get();if(v!=undefined){a(v).css("height",e);a(v).css("min-height",e);a(v).css("max-height",e)}});E=a(p).find("tr");B=new Array;a(E).each(function(){var b=new Array;var c=d["headercolumn"];var e=0;while(c>0){if(B[e]!=undefined&&B[e]>1){B[e]=B[e]-1;e++;c--;continue}var f=a(this).children().get(e);if(a(f).attr("rowspan")>1){B[e]=a(f).attr("rowspan");is_rowspan=true}b[e]=f;e++;c--}jQuery.each(b,function(c){a(b[c]).remove()})});i+="<table ";i+=b.getElementAttribute.apply(this,new Array(p));i=i.replace(/min-width:(\S|\s)[0-9]*(\S|\s)x;/i,"");i=i.replace(/min-width:(\S|\s)[0-9]*(\S|\s)x/i,"");i=i.replace(/max-width:(\S|\s)[0-9]*(\S|\s)x;/i,"");i=i.replace(/max-width:(\S|\s)[0-9]*(\S|\s)x/i,"");i=i.replace(/width:(\S|\s)[0-9]*(\S|\s)x;/i,"");i=i.replace(/width:(\S|\s)[0-9]*(\S|\s)x/i,"");i=i.replace(/width="[0-9]*px"/i,"");i+=">";i+=C+"</tbody>"+D+"</tfoot>";i+="</table>"}a(p).width(q-j);a(p).find("thead").children().length==0?a(p).find("thead").remove():null;var F="";if(f.length!=0||e.length!=0){F+='<div id="staticheader_hs_'+o+'"  >';if(f.length!=0){F+='<div id="staticheader_subhs1_'+o+'" style="float: left;">';F+=f;F+="</div>"}if(e.length!=0){F+='<div id="staticheader_subhs2_'+o+'" style="float: left; overflow: hidden;  width:'+(a(this).width()-j-s-2*d["headercolumn"]-20)+'px">';F+=e;F+="</div>"}F+="</div>"}F+='<div id="staticheader_hp_'+o+'">';if(i.length!=0){F+='<div id="staticheader_subhp1_'+o+'" style="float: left;">';F+='<div id="staticheader_chs_'+o+'" style="overflow: hidden; overflow: hidden; height: '+(a(this).height()-(h+35))+'px;">';F+=i;F+="</div>";F+="</div>"}F+='<div id="staticheader_subhp2_'+o+'" style="float: left">';F+='<div id="staticheader_cs_'+o+'" style="overflow: hidden; height: '+(a(this).height()-(h+35))+"px; width:"+(a(this).width()-j-s-2*d["headercolumn"]-20)+'"px>';F+=n.html();F+="</div>";F+="</div>";F+='<div id="staticheader_subhp3_'+o+'" style="float:left">';F+='<div id="staticheader_hscr_'+o+'" style="overflow: auto; width: 20px; height:'+(a(this).height()-(h+35))+'px;"><div style="margin: 0 0; padding:0 0; width: 1px; height: '+(a(p).height()+35)+'px;  background-color: grey"></div></div>';F+="</div>";F+="</div>";F+='<div id="staticheader_vscr_'+o+'" style="padding: 0px; margin-left:'+(d["headercolumn"]>0?j+s+2*d["headercolumn"]:0)+"px; float: left; overflow: auto;height: 20px; clear:both; width:"+(a(this).width()-j-s-2*d["headercolumn"]-20)+'"px; background-color: grey">';F+='<div style="margin: 0 0; padding:0 0;  width: '+(a(p).width()+s)+'px; height: 1px">';F+="</div>";F+="</div>";n.html(F);a("#staticheader_vscr_"+o).scroll(function(){a("#staticheader_subhs2_"+o).scrollLeft(a("#staticheader_vscr_"+o).scrollLeft());a("#staticheader_cs_"+o).scrollLeft(a("#staticheader_vscr_"+o).scrollLeft())});a("#staticheader_hscr_"+o).scroll(function(){a("#staticheader_cs_"+o).scrollTop(a("#staticheader_hscr_"+o).scrollTop());a("#staticheader_chs_"+o).scrollTop(a("#staticheader_hscr_"+o).scrollTop())});n.css("text-align","left")})},getElementAttribute:function(b){if(b==undefined){return""}var c=["border","class","style","cellpadding","cellspacing","valign","title","lang","dir","accesskey","tabindex","colspan","rowspan"];var d="";jQuery.each(c,function(c,e){if(a(b).attr(e)!=undefined&&a(b).attr(e)!=""){d+=this+'="'+a(b).attr(e)+'" '}});return d},getTableWidthOffset:function(a){var c=0;if(a.attr("border")!=undefined&&a.attr("border")!=""){c+=a.attr("border")*2}if(a.css("border-width")!=""){c+=b.px2Int(new Array(a.css("border-width")))*2}if(a.css("margin-left")!=""){c+=b.px2Int(new Array(a.css("margin-left")))}if(a.css("margin-right")!=""){c+=b.px2Int(new Array(a.css("margin-right")))}if(a.css("padding-left")!=""){c+=b.px2Int(new Array(a.css("padding-left")))}if(a.css("padding-right")!=""){c+=b.px2Int(new Array(a.css("padding-right")))}return c},getCellWidthOffset:function(c){var d=0;if(c.css("padding-left")!=""){d+=b.px2Int(new Array(a(c).css("padding-left")))}if(c.css("padding-right")!=""){d+=b.px2Int(new Array(a(c).css("padding-right")))}if(c.css("margin-left")!=""){d+=b.px2Int(new Array(a(c).css("margin-left")))}if(c.css("margin-right")!=""){d+=b.px2Int(new Array(a(c).css("margin-right")))}if(c.css("border-spacing")!=""){tmp_value=c.css("border-spacing").split(" ");d+=b.px2Int(new Array(tmp_value[0]));d+=b.px2Int(new Array(tmp_value[1]))}return d},getAbsoluteCellHeight:function(a){return a.height()>a[0].offsetHeight?a.height():a[0].offsetHeight},getAbsoluteCellWidth:function(a){return a.width()>a[0].offsetWidth?a.width():a[0].offsetWidth},px2Int:function(a){if(a==undefined||a==""){return 0}return a[0].replace(/px/i,"")*1}};a.fn.panesfreezer=function(c){if(b[c]){return b[c].apply(this,Array.prototype.slice.call(arguments,1))}else if(typeof c==="object"||!c){return b.init.apply(this,arguments)}else{a.error("Method "+c+" does not exist on jQuery.panesfreezer")}}})(jQuery)